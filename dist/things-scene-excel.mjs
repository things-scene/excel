import{DataSource as e,RectPath as t,Shape as r,Component as a}from"@hatiolab/things-scene";import i from"xlsx";var s="data:image/png;base64,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";const n={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"src",name:"src",placeholder:"Excel File URL"},{type:"number",label:"period",name:"period",placeholder:"seconds"}]};async function p(e){e.startsWith("data:")||(-1!==e.indexOf("?")?e+=`&ts=${Date.now()}`:e+=`?ts=${Date.now()}`);const t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/xlsx"},credentials:"include"}),r=i.read(await t.arrayBuffer(),{type:"array"});var a={};return r.SheetNames.forEach(e=>{var t=i.utils.sheet_to_json(r.Sheets[e]);t.length&&(a[e]=t)}),console.log("result",a),a}class o extends(e(t(r))){static get image(){return o._image||(o._image=new Image,o._image.src=s),o._image}dispose(){this._stopRepeater(),super.dispose()}ready(){const{src:e}=this.state;e&&this._initInterval()}render(e){var{left:t,top:r,width:a,height:i}=this.bounds;e.beginPath(),e.drawImage(o.image,t,r,a,i)}get nature(){return n}_initInterval(){this._stopRepeater(),this._startRepeater()}_startRepeater(){var{src:e,period:t}=this.state;t=Number(t);var r=!0;t&&this.app.isViewMode&&(this.repeatTimer=setInterval(()=>{r&&this.repeatTimer&&requestAnimationFrame(()=>{r=!0,p(e).then(e=>{this.setState("data",e)})}),r=!1},1e3*t)),p(e).then(e=>{this.setState("data",e)})}_stopRepeater(){this.repeatTimer&&clearTimeout(this.repeatTimer),delete this.repeatTimer}ondropfile(e,t){for(let r=0;r<e.length;r++)if(/\.xlsx?$/.test(e[r].name))return void(this.src=t[r])}onchange(e,t){("period"in e||"src"in e)&&this._initInterval()}}a.register("excel",o);export default[o];
//# sourceMappingURL=things-scene-excel.mjs.map
